# 1.开发工具准备及其配置
1. 开发工具 
    * JDK 8
    * Maven 3.6.3
    * MySQL 5.7
    * Chrome 浏览器(作为客户端使用)
    * Tomcat 9
    * IDEA 2020
2. 配置文件
    * 添加 Web 4.0 框架的支持
    * 配置 Tomcat 9 服务器(需要先配置 Web 框架才行)   
    * 更改 IDEA 默认使用的 Maven 版本
    * 更改 Project Structure-Module 中的语言版本，以及配置 Maven 中的语言版本
        ```xml
         <build>
                 <plugins>
                     <plugin>
                         <groupId>org.apache.maven.plugins</groupId>
                         <artifactId>maven-compiler-plugin</artifactId>
                         <!-- 更改 Maven 使用的 JDK 版本 -->
                         <configuration>
                             <source>8</source>
                             <target>8</target>
                         </configuration>
                     </plugin>
                 </plugins>
             </build>
        ```
      * 引入基本 jar 包
3. 测试项目是否能够成功启动
    * 项目无法成功启动之前千万不要开始编写代码
    * 否则会出现编写了很大一段代码之后，项目无法启动的情况
* 补充知识
    * 静态资源
    * 动态资源
    
启动 Bug: web 框架下面没有 WEB-INF 目录, 手动添加
参考解决方案: <a href="https://blog.csdn.net/qq_42035966/article/details/100904450">没有 WEB-INF 目录</a>

# 2. 明确项目需求
* 前端展示系统
    * 头条展示
    * 店铺类型展示
    * 区域展示: 校园区域
    * 店铺
    * 商品
* 店家系统
    * Local 账号管理
    * 微信账号管理
    * 店铺信息维护
    * 商品信息维护
    * 权限验证
* 管理员系统
    * 头条信息维护
    * 店铺类别信息维护
    * 校园区域信息维护
    * 权限验证
    * 店铺管理
    * 用户管理
    * 注意: 这里没有提供超级管理员对于商品信息的管理
1. 校园区域: 每个店铺都分布在校园的不同区域，所以需要作为相应的实体类，也就是一张表
2. 用户信息: 微信账号、本地账号、姓名等相关信息
3. 头条信息: 这个为什么要作为实体类?
4. 店铺类型、店铺信息
5. 商品类型、商品信息（详情图片，每个商品可以有多张图片对应）

# 3. 设计数据库表
1. 校园区域
    * 唯一标识符
    * 名称
    * 权重值（额外的）
    * 创建时间
    * 修改时间
    * 注意：建立实体类的时候使用的是引用类型，而不是基本数据类型？
2. 用户信息
    * 唯一标识符
    * 名称
    * 头像地址（这个也要作为属性？）
    * 邮箱
    * 性别(字符串表示)
    * 状态：（这个属性没太明白是干什么的）
    * 身份标识：顾客、店家、管理员
    * 创建时间
    * 修改时间
3. 微信账号
    * 唯一标识符
    * 用户标识符
    * openID?
    * 创建时间
    * 注意：没有修改时间？
4. 本地账号
    * 唯一标识符
    * 用户标识符
    * 账号
    * 密码
    * 创建时间
5. 头条信息
    * 唯一标识符
    * 名称
    * 状态
    * 链接
    * 权重
    * 图片
    * 创建时间
6. 店铺类别
    * 唯一标识符
    * 父类唯一标识符
    * 名称
    * 权重
    * 描述
    * 图片
    * 创建时间
    * 修改时间
7. 店铺信息
    * 唯一标识符
    * 缩略图地址
    * 店名
    * 描述信息
    * 联系方式
    * 地址
    * 权重
    * 店铺类型标识符
    * 区域信息标识符
    * 用户信息标识符
    * 状态
    * 创建时间
    * 修改时间
    * 建议（超级管理员的）
8. 商品类型
    * 唯一标识符
    * 店铺标识符
    * 类型名称
    * 权重
9. 商品图片
    * 唯一标识符
    * 图片地址
    * 图片说明
    * 显示权重
    * 创建时间
    * 商品信息标识符
10. 商品信息





* 补充知识
    * datetime 和 timestamp 区别: datetime 的时间范围更为广泛, timestamp 能够自适应时区
    * InnoDB 和 MYISAM 两者的区别(数据库必问)
        * MYISAM 查询数据的时候会锁住整张表，但是读取性能非常高，不支持事务
        * InnoDB 查询数据的时候仅会锁住一行而不是整张表, 但是写入的性能更高，支持事务
    * 索引

# 4. 构建项目目录
* entity 实体类层
* dao 数据库控制层
* service 业务逻辑层
* controller 控制层
* interceptor 事务拓展 / 横切层
* dto 弥补实体类层的不足
* utils 工具类
* mapper 编写 SQL 文件
* spring spring 配置文件

* 问题: WEB-INF 文件夹消失不见

# 5. 引入依赖
```xml
<!-- 版本控制 -->
<properties>
        <!-- Spring 版本控制 -->
        <spring.version>5.3.4</spring.version>
</properties>
```
```xml
<dependencies>
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.16.22</version>
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.13</version>
        </dependency>

        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-core</artifactId>
            <version>1.2.3</version>
            <!-- 希望日志出现在线上环境而不只是测试单元, 所以没有添加 scope -->
        </dependency>

        <!-- Spring 核心 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <!-- IOC -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-beans</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <!-- 事务横切 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <!-- web -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <!-- spring test 对 JUnit 进行了简单的封装 -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>${spring.version}</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>4.0.1</version>
        </dependency>

        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.8.8</version>
        </dependency>

        <!-- 对集合工具类的扩展 Spring-core 需要 commons 支持 -->
        <dependency>
            <groupId>commons-collections</groupId>
            <artifactId>commons-collections</artifactId>
            <version>3.2.2</version>
        </dependency>

        <!-- Mybatis -->
        <dependency>
            <groupId>org.mybatis</groupId>
            <artifactId>mybatis</artifactId>
            <version>3.5.3</version>
        </dependency>

        <dependency>
            <groupId>org.mybatis</groupId>
            <artifactId>mybatis-spring</artifactId>
            <version>2.0.2</version>
        </dependency>

        <!-- MySQL -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.47</version>
        </dependency>

        <dependency>
            <groupId>com.mchange</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.5.5</version>
        </dependency>

    </dependencies>
```

#6. 配置相关文件
1. 数据库配置文件

2. Mybatis 配置文件

3. Spring 配置文件

```xml
<!-- 启用 SpringMVC 注解 -->
<mvc:annotation-driven/>

<!-- 静态资源不会被 dispatcherServlet 拦截, 交给默认的 Servlet 处理 -->
<mvc:resources mapping="/resources/**" location="/resources"/>
<mvc:default-servlet-handler/>
<!-- 定义视图解析器 -->
<bean id="resolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/html"/>
    <property name="suffix" value=".html"/>
</bean>

<!-- 扫描 Web 相关的对象 -->
<context:component-scan base-package="com.o2o.controller"/>
<servlet>
    <servlet-name>spring-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <!-- 初始参数 -->
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:spring/spring-*.xml</param-value>
    </init-param>
</servlet>

<servlet-mapping>
    <servlet-name>spring-dispatcher</servlet-name>
    <!-- 默认所有 URL 请求都会转入到 Dispatcher 处理（静态资源除外） -->
    <url-pattern>/</url-pattern>
</servlet-mapping>
```

#7 测试是否成功配置

* 问题: SQL 没有自动提示
* 问题: Web 框架 和 Tomcat 服务器突然消失
* 问题: Spring 配置文件突然无法整合
* 问题: 单元测试失败
* 问题: Maven 无法使用, artifactId 切记不要使用中文
* 问题: 访问 Controller 出现 404 错误, 没有导包, 没有开启注解机制
* 问题: 访问 Controller 出现 500 问题, Jackson 依赖没有进入, 自动注入错误
* 问题: json 数据可视化 JsonViewer

#8 MySQL 驱动升级
* 为什么大公司喜欢用旧版本

1. 连接远程服务器: 服务器的 IP 地址、服务器上 MySQL 对应的账号密码都需要在 properties 文件中修改
2. 更新数据库驱动

源码重点: SpringMVC DispatcherServlet Spring IOC AOP Mybatis ORM

#9 Logback 日志配置
* 组成模块
    * logback-access: 第三方软件可以通过这个模块访问系统的日志
    * logback-classic: log4j 的改良版本
    * logback-core:
* 主要标签
    * logger: 日志实例对象
    * appender: 指定日志输出的地址
    * layout: 格式化日志信息输出
* 问题: log4j 和 slf4j 有什么区别
* 问题: 没有找到 slf4j 类, 原因: 相关依赖没有进入项目中
* 问题: 日志没有生成？





